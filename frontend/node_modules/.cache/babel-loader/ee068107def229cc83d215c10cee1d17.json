{"ast":null,"code":"import _toConsumableArray from\"/home/rafael/dev/base_app/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/rafael/dev/base_app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/rafael/dev/base_app/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/rafael/dev/base_app/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/rafael/dev/base_app/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useState}from'react';import{useQuery}from'react-query';// Components\nimport Item from'./Components/Item/Item';import Cart from'./Components/Cart/Cart';import{Drawer}from'@material-ui/core';import{LinearProgress}from'@material-ui/core';import Grid from'@material-ui/core/Grid';import{AddShoppingCart}from'@material-ui/icons';import Badge from'@material-ui/core/Badge';// Styles\nimport{Wrapper,StyledButton}from'./App.styles';// Services\nimport api from'./services/fakestoreapi';// Types\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var getProducts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return api.get('/products');case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);}));return function getProducts(){return _ref.apply(this,arguments);};}();var App=function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),cartOpen=_useState2[0],setCartOpen=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),cartItems=_useState4[0],setCartItems=_useState4[1];var _useQuery=useQuery('products',getProducts),data=_useQuery.data,isLoading=_useQuery.isLoading,error=_useQuery.error;var getTotalItems=function getTotalItems(items){return items.reduce(function(ack,item){return ack+item.amount;},0);};var handleAddToCart=function handleAddToCart(clickedItem){setCartItems(function(prev){// 1. Is the item already added in the cart?\nvar isItemInCart=prev.find(function(item){return item.id===clickedItem.id;});if(isItemInCart){return prev.map(function(item){return item.id===clickedItem.id?_objectSpread(_objectSpread({},item),{},{amount:item.amount+1}):item;});}// First time the item is added\nreturn[].concat(_toConsumableArray(prev),[_objectSpread(_objectSpread({},clickedItem),{},{amount:1})]);});};var handleRemoveFromCart=function handleRemoveFromCart(id){setCartItems(function(prev){return prev.reduce(function(ack,item){if(item.id===id){if(item.amount===1)return ack;return[].concat(_toConsumableArray(ack),[_objectSpread(_objectSpread({},item),{},{amount:item.amount-1})]);}else{return[].concat(_toConsumableArray(ack),[item]);}},[]);});};if(isLoading)return/*#__PURE__*/_jsx(LinearProgress,{});if(error)return/*#__PURE__*/_jsx(\"div\",{children:\"Something went wrong ...\"});return/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsx(Drawer,{anchor:\"right\",open:cartOpen,onClose:function onClose(){return setCartOpen(false);},children:/*#__PURE__*/_jsx(Cart,{cartItems:cartItems,addToCart:handleAddToCart,removeFromCart:handleRemoveFromCart})}),/*#__PURE__*/_jsx(StyledButton,{onClick:function onClick(){return setCartOpen(true);},children:/*#__PURE__*/_jsx(Badge,{badgeContent:getTotalItems(cartItems),color:\"error\",children:/*#__PURE__*/_jsx(AddShoppingCart,{})})}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:data===null||data===void 0?void 0:data.map(function(item){return/*#__PURE__*/_jsx(Grid,{item:true,xl:2,lg:3,md:4,sm:6,xs:12,children:/*#__PURE__*/_jsx(Item,{item:item,handleAddToCart:handleAddToCart})},item.id);})})]});};export default App;","map":{"version":3,"names":["useState","useQuery","Item","Cart","Drawer","LinearProgress","Grid","AddShoppingCart","Badge","Wrapper","StyledButton","api","getProducts","get","App","cartOpen","setCartOpen","cartItems","setCartItems","data","isLoading","error","getTotalItems","items","reduce","ack","item","amount","handleAddToCart","clickedItem","prev","isItemInCart","find","id","map","handleRemoveFromCart"],"sources":["/home/rafael/dev/base_app/frontend/src/App.tsx"],"sourcesContent":["import { useState } from 'react'\nimport {useQuery } from 'react-query'\n\n// Components\nimport Item from './Components/Item/Item';\nimport Cart from './Components/Cart/Cart';\nimport { Drawer } from '@material-ui/core';\nimport { LinearProgress } from '@material-ui/core';\nimport Grid from '@material-ui/core/Grid';\nimport { AddShoppingCart } from '@material-ui/icons';\nimport Badge from '@material-ui/core/Badge';\n\n// Styles\nimport { Wrapper, StyledButton } from './App.styles';\n\n// Services\nimport api from './services/fakestoreapi';\n\n// Types\nexport type CartItemType = {\n  id: number;\n  category: string;\n  description: string;\n  image: string;\n  price: number;\n  title: string;\n  amount: number;\n}\n\nconst getProducts = async (): Promise<CartItemType[]> =>\n  await api.get('/products');\n\nconst App = () => {\n  const [cartOpen, setCartOpen] = useState(false);\n  const [cartItems, setCartItems] = useState([] as CartItemType[]);\n  const { data, isLoading, error } = useQuery<CartItemType[]>(\n    'products',\n    getProducts\n  )\n  const getTotalItems = (items: CartItemType[]) =>\n    items.reduce((ack: number, item) => ack + item.amount, 0)\n  const handleAddToCart = (clickedItem: CartItemType) => {\n    setCartItems(prev => {\n      // 1. Is the item already added in the cart?\n      const isItemInCart = prev.find(item => item.id === clickedItem.id)\n\n      if (isItemInCart) {\n        return prev.map(item => \n          item.id === clickedItem.id\n            ? { ...item, amount: item.amount + 1 }\n            : item\n        );\n      }\n      // First time the item is added\n      return [ ...prev, { ...clickedItem, amount: 1}]\n    })\n  };\n  const handleRemoveFromCart = (id: number) => {\n    setCartItems(prev =>(\n      prev.reduce((ack, item) => {\n        if (item.id === id) {\n          if(item.amount === 1) return ack;\n          return [...ack, { ...item, amount: item.amount - 1}];\n        }else {\n          return [...ack, item];\n        }\n      }, [] as CartItemType[])\n    ))\n  };\n\n  if (isLoading) return <LinearProgress/>;\n  if (error) return <div>Something went wrong ...</div>\n\n  return (\n    <Wrapper>\n      <Drawer anchor='right' open={cartOpen} onClose={() => setCartOpen(false)}>\n        <Cart \n          cartItems={cartItems}\n          addToCart={handleAddToCart}\n          removeFromCart={handleRemoveFromCart}\n        />\n      </Drawer>\n      <StyledButton onClick={() => setCartOpen(true)}>\n        <Badge badgeContent={getTotalItems(cartItems)} color='error'>\n          <AddShoppingCart />\n        </Badge>\n      </StyledButton>\n      <Grid container spacing={3}>\n        {data?.map(item => (\n          <Grid item key={item.id} xl={2} lg={3} md={4} sm={6} xs={12}>\n            <Item item={item} handleAddToCart={handleAddToCart}/>\n          </Grid>\n        ))}\n      </Grid>\n    </Wrapper>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}